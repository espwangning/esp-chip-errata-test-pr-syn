[AES|XTS-AES] 涉及 CPA 攻击的安全漏洞
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. only:: esp32h2

   .. tags::
      
      v0.0, v0.1

描述
^^^^

芯片的 flash 加密功能基于 XTS-AES。攻击者通过结合运用功耗分析 (CPA)、故障注入 (FI) 和缓冲区溢出等攻击手段，可以绕过 flash 加密及安全启动。

变通方法
^^^^^^^^

加密密钥如果与其他设备或制造批次相同，一定不能长期使用。建议同时开启 flash 加密和安全启动功能，最大限度减少攻击者重写固件的风险。

解决方案
^^^^^^^^

已在芯片版本 :bdg-success:`v1.2` 中修复。芯片版本 v1.2 中引入了抗攻击伪轮函数，可有效抵抗 CPA 攻击。
